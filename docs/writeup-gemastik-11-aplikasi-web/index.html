<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="cacadosman">
<meta name="description" content="Terdapat sebuah service yang memiliki source code seperti berikut:
Simpelnya, kita perlu membayar minimal amount 20000 untuk mendapatkan sebuah flag. Akan tetapi tidak semudah itu karena pada proses check, kita hanya diperbolehkan memasukkan amount max 10000. Walaupun dilakukan inspect element, itu percuma saja karena disini dilakukan pengecekan hash untuk memastikan integritas data dari form sebelumnya itu isinya sama dengan form yang akan disubmit.
Menariknya, kode diatas terdapat sebuah celah keamanan yang sangat fatal." />
<meta name="keywords" content="tutorial, computer, computer science, programming, php, html, python, js, javascript, ctf, gemastik, gemastik 11, gemastik xi, tutorial, web exploit" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://cacadosman.my.id/writeup-gemastik-11-aplikasi-web/" />


    <title>
        
            Writeup Gemastik 11 - Aplikasi Web (?) :: Infinite Overflow  â€” Sebuah Coretan Tak Bermakna
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.5dcefbf8102eb536dd3e2de53ffebfa58599ab2435c241a0db81728a5e015f2e.css">




<meta itemprop="name" content="Writeup Gemastik 11 - Aplikasi Web (?)">
<meta itemprop="description" content="Terdapat sebuah service yang memiliki source code seperti berikut:
Simpelnya, kita perlu membayar minimal amount 20000 untuk mendapatkan sebuah flag. Akan tetapi tidak semudah itu karena pada proses check, kita hanya diperbolehkan memasukkan amount max 10000. Walaupun dilakukan inspect element, itu percuma saja karena disini dilakukan pengecekan hash untuk memastikan integritas data dari form sebelumnya itu isinya sama dengan form yang akan disubmit.
Menariknya, kode diatas terdapat sebuah celah keamanan yang sangat fatal.">
<meta itemprop="datePublished" content="2018-10-04T06:37:23+00:00" />
<meta itemprop="dateModified" content="2018-10-04T06:37:23+00:00" />
<meta itemprop="wordCount" content="153">
<meta itemprop="image" content="https://cacadosman.my.id/"/>



<meta itemprop="keywords" content="ctf,gemastik,gemastik 11,gemastik xi,tutorial,web exploit," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://cacadosman.my.id/"/>

<meta name="twitter:title" content="Writeup Gemastik 11 - Aplikasi Web (?)"/>
<meta name="twitter:description" content="Terdapat sebuah service yang memiliki source code seperti berikut:
Simpelnya, kita perlu membayar minimal amount 20000 untuk mendapatkan sebuah flag. Akan tetapi tidak semudah itu karena pada proses check, kita hanya diperbolehkan memasukkan amount max 10000. Walaupun dilakukan inspect element, itu percuma saja karena disini dilakukan pengecekan hash untuk memastikan integritas data dari form sebelumnya itu isinya sama dengan form yang akan disubmit.
Menariknya, kode diatas terdapat sebuah celah keamanan yang sangat fatal."/>



    <meta property="article:section" content="CTF" />

    <meta property="article:section" content="Cyber Security" />

    <meta property="article:section" content="Gemastik" />

    <meta property="article:section" content="Tutorial" />



    <meta property="article:published_time" content="2018-10-04 06:37:23 &#43;0000 &#43;0000" />








    </head>

    <body class="">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">Infinite Overflow</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://cacadosman.my.id/about">About</a></li><li><a href="https://cacadosman.my.id/chat">Chatbox</a></li><li><a href="https://cacadosman.my.id/posts">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://cacadosman.my.id/writeup-gemastik-11-aplikasi-web/">Writeup Gemastik 11 - Aplikasi Web (?)</a></h2>

            

            <div class="post-content">
                <p>Terdapat sebuah service yang memiliki source code seperti berikut:</p>
<p><img src="/wp-content/2018/10/Aplikasi-Web.png" alt=""></p>
<p>Simpelnya, kita perlu membayar minimal amount 20000 untuk mendapatkan sebuah flag. Akan tetapi tidak semudah itu karena pada proses check, kita hanya diperbolehkan memasukkan amount max 10000. Walaupun dilakukan inspect element, itu percuma saja karena disini dilakukan pengecekan hash untuk memastikan integritas data dari form sebelumnya itu isinya sama dengan form yang akan disubmit.</p>
<p>Menariknya, kode diatas terdapat sebuah celah keamanan yang sangat fatal.</p>
<p><img src="/wp-content/2018/10/hashh.png" alt=""></p>
<p>Kode diatas melakukan sorting pada key berdasarkan lexicographical order dan hanya melakukan hashing pada value nya saja menggunakan sha256. Karena hanya melakukan pengecekan nilai nya saja, otomatis disini kita bisa melakukan manipulasi key berdasarkan lexicographical order agar urutan value yang dihash tetap sama saja pada endpoint /check dan /pay :)</p>
<p>Cara mudahnya bisa kita inject menggunakan postman saja:</p>
<p>Saat melakukan injeksi pada /check :</p>
<p><img src="/wp-content/2018/10/hash1.png" alt=""></p>
<p>Kemudian, kita lanjutkan injeksi pada /pay :</p>
<p><img src="/wp-content/2018/10/hash2.png" alt=""></p>
<p>Akhirnya kita mendapatkan sebuah flag :
<strong>GEMASTIK{Be_CaReful_WH4t_You_H4SH}</strong></p>
<p>Terima Kasih.</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
  				<p>
  					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://cacadosman.my.id/tags/ctf">ctf</a></span><span class="tag"><a href="https://cacadosman.my.id/tags/gemastik">gemastik</a></span><span class="tag"><a href="https://cacadosman.my.id/tags/gemastik-11">gemastik 11</a></span><span class="tag"><a href="https://cacadosman.my.id/tags/gemastik-xi">gemastik xi</a></span><span class="tag"><a href="https://cacadosman.my.id/tags/tutorial">tutorial</a></span><span class="tag"><a href="https://cacadosman.my.id/tags/web-exploit">web exploit</a></span>
  				</p>
  			</div>

        
          <div id="comments" class="thin">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "infinite-overflow" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2022</span>
            
            <span>cacadosman</span>
            <span> <a href="https://cacadosman.my.id/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.2d5469329143160ae2456a69c3c76dc2d0a3b212b46afe291a51bd68650ed6f8697e001dab54f1c272c77ce08092a8c55e5bb4314e0ee334aab4b927ec896638.js" integrity="sha512-LVRpMpFDFgriRWppw8dtwtCjshK0av4pGlG9aGUO1vhpfgAdq1TxwnLHfOCAkqjFXlu0MU4O4zSqtLkn7IlmOA=="></script>



    </body>
</html>
